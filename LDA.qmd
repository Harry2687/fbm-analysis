---
title: "Latent Dirichlet Allocation"
format: html
---

```{python}
import modules.preprocessing as prep
import modules.lda.preprocessing as lda_prep
import modules.lda.models as lda_models
import gensim as gs
```

Import and clean data.

```{python}
chat_data = prep.ms_import_data('data/the_office')
chat_data = lda_prep.lda_preprocess(chat_data, 'content', 'clean_content')
```

Count number of occurances of specified word by sender.

```{python}
chat_data_with_stopwords = prep.ms_import_data('data/the_office')
chat_data_with_stopwords = lda_prep.lda_preprocess(chat_data_with_stopwords, 'content', 'clean_content', False)
word_count = prep.sender_wordcount(chat_data_with_stopwords, 'coc')
word_count
```

Split messages into conversations which are separated by at least 10 minutes.

```{python}
documents = lda_prep.lda_getdocs(chat_data, 'clean_content', 'timestamp')
```

Run LDA, where documents are the previously defined conversations.

```{python}
model = lda_models.fbm_lda(documents)
model.train_lda(5)
model.print_topics()
```

```{python}
model.get_coherence()
```

Hyperparameter tuning

```{python}
tuning = lda_models.tune_lda(documents)
tuning_results = tuning.tune(2, 4, 1)
```